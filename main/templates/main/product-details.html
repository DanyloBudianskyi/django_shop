{% extends 'main/base.html' %}
{% block title %}{{ product.title }}{% endblock %}

{% load shop_filters %}

{% block content %}
<article class="max-w-4xl mx-auto bg-white rounded-lg shadow-md overflow-hidden p-6">

  <div class="mb-6 text-center">
    <h1 class="text-3xl font-bold text-indigo-600 mb-2">{{ product.name }}</h1>
    <div class="flex flex-wrap justify-center gap-3 text-sm text-gray-500">
      <span class="meta-item">üë§ {{ product.category }}</span>
      <span class="meta-item">üìÖ {{ product.created_at|time_ago }}</span>
      <span class="meta-item">üëÅÔ∏è {{ product.views }} –ø–µ—Ä–µ–≥–ª—è–¥—ñ–≤</span>
      <span class="meta-item">üìÇ 
        <a href="{{ product.category.get_absolute_url }}" class="text-indigo-600 hover:underline">{{ product.category.name }}</a>
      </span>
    </div>
  </div>

  {% if product.image %}
  <div class="flex justify-center mb-6">
    <img src="{{ product.image.url }}" alt="{{ product.title }}" class="rounded-lg shadow-sm max-h-96 object-contain">
  </div>
  {% endif %}

  <div class="mb-6">
    <p class="text-xl font-semibold text-indigo-700 mb-4">üí∞ –¶—ñ–Ω–∞: {{ product.price|currency }}</p>
    <div class="prose prose-indigo max-w-none">
      {{ product.description|markdown }}
    </div>
  </div>

  <div class="flex flex-col sm:flex-row justify-between items-center gap-4 border-t border-gray-200 pt-4">
    <p class="text-sm text-gray-500">–û–Ω–æ–≤–ª–µ–Ω–æ: {{ product.updated_at|date:"d.m.Y H:i" }}</p>
    
    <div class="flex gap-3 flex-wrap">
      <a href="{% url 'main:product_list' %}" class="btn btn-outline btn-sm">‚Üê –ü–æ–≤–µ—Ä–Ω—É—Ç–∏—Å—è –¥–æ —Å–ø–∏—Å–∫—É</a>
      <form style="display:inline;">
        <button class="btn btn-primary btn-sm">–î–æ–¥–∞—Ç–∏ –≤ –∫–æ—à–∏–∫</button>
      </form>
    </div>
  </div>
</article>

{% if product %}
<section class="max-w-7xl mx-auto mt-12">
  <h2 class="text-2xl font-bold text-indigo-600 mb-6 text-center">–°—Ö–æ–∂—ñ –ø—Ä–æ–¥—É–∫—Ç–∏</h2>
  <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6">
    {% for related in related_products %}
    <div class="bg-white rounded-lg shadow-md p-4 hover:shadow-lg transition">
      {% if related.image %}
      <img src="{{ related.image.url }}" alt="{{ related.name }}" class="rounded-md mb-3 h-48 w-full object-cover">
      {% endif %}
      <h3 class="text-lg font-semibold mb-1 text-gray-800">{{ related.name }}</h3>
      <p class="text-sm text-gray-600 mb-3">{{ related.description|truncatewords:15 }}</p>
      <a href="{{ related.get_absolute_url }}" class="text-indigo-600 hover:underline font-medium">–ß–∏—Ç–∞—Ç–∏ –¥–∞–ª—ñ ‚Üí</a>
    </div>
    {% endfor %}
  </div>
</section>
{% endif %}
{% endblock %}
